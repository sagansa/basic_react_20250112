import{r as F,j as e}from"./app-C6TZeccX.js";import{I as c}from"./InputError-BdIwntLj.js";import{I as o}from"./InputLabel-BnJ3Sk5Y.js";import{P as v}from"./PrimaryButton-CeVkU3Vv.js";import{T as g}from"./TextInput-C1j5k6Oi.js";import{S as f}from"./SelectInput-BX9ig2w9.js";import{D as T}from"./DangerButton-COoC9oes.js";function K({data:i,setData:u,errors:n,processing:h,submit:N,subjects:j}){const[s,p]=F.useState({subject_id:"",type:"",grade:"",kkm:"",date:""}),y=(a,t)=>!a||!t?"":Math.max(0,parseInt(a)-parseInt(t)),b=(a,t)=>parseInt(a)===100?1e5:parseInt(t)*1e3,d=(a,t)=>{p(r=>({...r,[a]:t}))},w=()=>{if(!s.subject_id||!s.type||!s.grade||!s.kkm||!s.date)return;const a=y(s.grade,s.kkm),t=a!==""?b(s.grade,a):"",r={id:Date.now(),...s,difference:a,reward_amount:t,created_at:new Date().toISOString()},l=[...i.grades,r];u(m=>({...m,grades:l,total_reward_amount:l.reduce((_,I)=>_+(I.reward_amount||0),0)})),p({subject_id:"",type:"",grade:"",kkm:"",date:""})},k=a=>{const t=i.grades.filter((l,m)=>m!==a);u("grades",t);const r=t.reduce((l,m)=>l+(m.reward_amount||0),0);u("total_reward_amount",r)},x=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a||0);return e.jsx("form",{onSubmit:N,className:"container mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"space-y-4 lg:col-span-2",children:e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow dark:bg-gray-800",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tambah Nilai Baru"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(o,{htmlFor:"subject",value:"Mata Pelajaran"}),e.jsxs(f,{id:"subject",value:s.subject_id,onChange:a=>d("subject_id",a.target.value),className:"mt-1 w-full",children:[e.jsx("option",{value:"",children:"Pilih Mata Pelajaran"}),j.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(c,{message:n.subject_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"type",value:"Tipe"}),e.jsxs(f,{id:"type",value:s.type,onChange:a=>d("type",a.target.value),className:"mt-1 w-full",children:[e.jsx("option",{value:"",children:"Pilih Tipe"}),e.jsx("option",{value:"quiz",children:"Kuis"}),e.jsx("option",{value:"assignment",children:"Tugas"}),e.jsx("option",{value:"exam",children:"Ujian"}),e.jsx("option",{value:"other",children:"Lainnya"})]}),e.jsx(c,{message:n.type,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"grade",value:"Nilai"}),e.jsx(g,{id:"grade",type:"number",value:s.grade,onChange:a=>d("grade",a.target.value),className:"mt-1 w-full"}),e.jsx(c,{message:n.grade,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"kkm",value:"KKM"}),e.jsx(g,{id:"kkm",type:"number",value:s.kkm,onChange:a=>d("kkm",a.target.value),className:"mt-1 w-full"}),e.jsx(c,{message:n.kkm,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"date",value:"Tanggal"}),e.jsx(g,{id:"date",type:"date",value:s.date,onChange:a=>d("date",a.target.value),className:"mt-1 w-full"}),e.jsx(c,{message:n.date,className:"mt-2"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(v,{type:"button",onClick:w,className:"w-full",disabled:!s.subject_id||!s.type||!s.grade||!s.kkm||!s.date,children:"Tambah Nilai"})})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-4 p-6 bg-white rounded-lg shadow dark:bg-gray-800",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Ringkasan Reward"}),e.jsxs("div",{className:"space-y-4",children:[i.grades.map((a,t)=>{var r;return e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg dark:bg-gray-700",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:((r=j.find(l=>l.id===parseInt(a.subject_id)))==null?void 0:r.name)||"Mata Pelajaran"}),e.jsx(T,{type:"button",onClick:()=>k(t),className:"px-2 py-1",children:"Hapus"})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{className:"font-medium capitalize",children:a.type}),e.jsx("div",{className:"text-right font-medium",children:new Date(a.date).toLocaleDateString()}),e.jsxs("div",{className:"font-medium",children:["Nilai: ",a.grade]}),e.jsxs("div",{className:"text-right font-medium",children:["KKM: ",a.kkm]}),e.jsxs("div",{className:"col-span-2 text-right font-medium text-green-600 dark:text-green-400",children:["+",a.difference," poin = ",x(a.reward_amount)]})]}),e.jsx("div",{className:"pt-2 mt-2 border-t border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total:"}),e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:x(a.reward_amount)})]})})]})]})})},a.id)}),e.jsx("div",{className:"pt-4 mt-4 border-t",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold",children:[e.jsx("span",{children:"Total Reward:"}),e.jsx("span",{className:"text-lg text-green-600 dark:text-green-400",children:x(i.total_reward_amount)})]})}),e.jsx(v,{className:"mt-4 w-full",disabled:h||i.grades.length===0,children:h?"Menyimpan...":"Simpan Reward"})]})]})})]})})}export{K as default};
